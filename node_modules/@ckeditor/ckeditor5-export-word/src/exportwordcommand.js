/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x41e973}from'ckeditor5/src/core.js';import{getStyles as _0x5c3da4,getConverterOptions as _0x576102,getConverterOptionsV2 as _0x2a48e4}from'./utils.js';export default class e extends _0x41e973{constructor(_0x50c636){super(_0x50c636),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x206c4e={}){const _0x56928e=this['editor'],t=_0x56928e['t'],_0x539f8d=0x2===(_0x206c4e['version']||0x1),_0x9549e6=_0x206c4e['converterUrl']||(_0x539f8d?'https://docx-converter.cke-cs.com/v2/convert/html-docx':'https://docx-converter.cke-cs.com/v1/convert'),_0x1a8f17=_0x206c4e['converterOptions']||{},_0x8e651d=_0x56928e['plugins']['get']('ExportWord'),_0x369bbd=_0x206c4e['token']||_0x8e651d['_token'],_0x131034=!0x1!==_0x1a8f17['auto_pagination'],_0x4d54fa=_0x206c4e['dataCallback']||(_0x7ca7ed=>_0x7ca7ed['data']['get']({'pagination':_0x131034}));return this['isBusy']=!0x0,this['refresh'](),_0x5c3da4(_0x206c4e['stylesheets']||['EDITOR_STYLES'])['then'](async _0x106ecb=>{_0x56928e['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20started'));const _0x3923b6=await _0x4d54fa(_0x56928e),_0x14997b={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x56928e['locale']['contentLanguageDirection']+'\x22>'+_0x3923b6+'</div>','css':_0x106ecb,[_0x539f8d?'config':'options']:{..._0x1a8f17,..._0x539f8d?_0x2a48e4(_0x56928e):_0x576102(_0x56928e)}},_0x2d03bf={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x369bbd?{'Authorization':_0x369bbd['value']}:null},'body':JSON['stringify'](_0x14997b)};return window['fetch'](_0x9549e6,_0x2d03bf)['then'](_0x555542=>{if(0xc8!==_0x555542['status'])throw _0x555542;return _0x555542['blob']();})['then'](_0x49b0d6=>{_0x56928e['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20successful'));const _0x426b0a='function'==typeof _0x206c4e['fileName']?_0x206c4e['fileName']():_0x206c4e['fileName'];this['_downloadFile'](_0x49b0d6,_0x426b0a||'document.docx');});})['catch'](_0x522e0a=>{const _0x67d4fb=_0x56928e['plugins']['get']('Notification');throw _0x56928e['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x67d4fb['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x522e0a;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x309b6d,_0x1d979c){const _0x2f9168=document['createElement']('a');_0x2f9168['href']=window['URL']['createObjectURL'](_0x309b6d),_0x2f9168['download']=_0x1d979c,_0x2f9168['click'](),_0x2f9168['remove']();}}