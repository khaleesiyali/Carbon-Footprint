/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
function _0x105b(_0x3f44b4,_0xdbfc12){const _0x3037cd=_0x3037();return _0x105b=function(_0x105b60,_0x58df11){_0x105b60=_0x105b60-0xc5;let _0x236216=_0x3037cd[_0x105b60];return _0x236216;},_0x105b(_0x3f44b4,_0xdbfc12);}const _0x1d5272=_0x105b;function _0x3037(){const _0x355c67=['getComment','getCommentThreads','6471adMbLq','commentThreadAdded','assign','6114yJltUx','_getService','getUser','init','getMany','startsWith','1682058KMuUFr','addToReconnectionStack','_connectService','sessionAdd:','get','authorId','comments','config','map','CloudServicesCommentsAdapter','cloud-services-internal-error:\x20Not\x20connected.','createdAt','add','resolvedBy','commentAdded','addComment','remove','has','cloudservicescommentsadapter-service-not-exist','requires','message','delete','listenTo','destroy','58dSbDox','CommentsRepository','keys','commentThreadId','commentId','mySessionId','catch','collaboration.channelId','addUser','removeComment','cloudservicescommentsadapter-connect-already-connected','connect','updateCommentThread','cloudservicescommentsadapter-disconnect-not-exist','plugins','CommentsService','commentRemoved','commentThreadResolved','size','set','348139pkBrMH','resolvedAt','update','1460488oTWEIg','cloud-services-internal-error:\x20Comments\x20Service\x20is\x20not\x20connected.','_fetchMissingUsersForThreads','_setUpService','context','updateComment','register','from','permissions','off','userId','_services','attributes','commentUpdated','19020VxswsI','commentThreadRemoved','resolve','code','getConnectedSessions','pluginName','commentThreadReopened','content','adapter','_terminateService','unregister','commentThreadUpdated','87870YBgFUB','deletedAt','cloud-services-internal-error:\x20Request\x20timeout.','removeCommentThread','addCommentThread','getCommentThread','resolveCommentThread','disconnect','setPermissions','reconnect','968BUHZWE','404','reopenCommentThread','reopen','Permissions','160WAwmXT'];_0x3037=function(){return _0x355c67;};return _0x3037();}(function(_0x27fdbc,_0x5e6a22){const _0x230b26=_0x105b,_0x1afe33=_0x27fdbc();while(!![]){try{const _0x3bfaf4=-parseInt(_0x230b26(0x118))/0x1+-parseInt(_0x230b26(0x104))/0x2*(parseInt(_0x230b26(0xc5))/0x3)+parseInt(_0x230b26(0x11b))/0x4+-parseInt(_0x230b26(0xe0))/0x5*(-parseInt(_0x230b26(0xe6))/0x6)+parseInt(_0x230b26(0xec))/0x7+parseInt(_0x230b26(0xdb))/0x8*(parseInt(_0x230b26(0xe3))/0x9)+-parseInt(_0x230b26(0xd1))/0xa;if(_0x3bfaf4===_0x5e6a22)break;else _0x1afe33['push'](_0x1afe33['shift']());}catch(_0x509e22){_0x1afe33['push'](_0x1afe33['shift']());}}}(_0x3037,0x2cfad));import{Context as _0x1bac0c,ContextPlugin as _0x293472}from'ckeditor5/src/core.js';import{CKEditorError as _0xf8138b}from'ckeditor5/src/utils.js';import{Users as _0x4e1e0d}from'ckeditor5-collaboration/src/collaboration-core.js';import{CommentsService as _0x2163d8,User as _0x42be7d}from'@ckeditor/ckeditor-cloud-services-collaboration/src/services.js';import _0x2d787e from'../realtimecollaborativeediting/websocketgateway.js';import _0xb41493 from'../realtimecollaborativeediting/sessions.js';class a extends _0x293472{static get[_0x1d5272(0xff)](){const _0xe20837=_0x1d5272;return[_0x2d787e,_0xe20837(0x105),_0xb41493,_0x4e1e0d];}static get[_0x1d5272(0xca)](){const _0x36724e=_0x1d5272;return _0x36724e(0xf5);}constructor(_0xbabfcb){const _0x376664=_0x1d5272;super(_0xbabfcb),this[_0x376664(0x126)]=new Map();}async[_0x1d5272(0xe9)](){const _0x4314bf=_0x1d5272,_0x51c246=this[_0x4314bf(0x11f)],_0x461394=_0x51c246[_0x4314bf(0x112)][_0x4314bf(0xf0)](_0x4314bf(0x105));if(_0x51c246[_0x4314bf(0x112)][_0x4314bf(0xf0)](_0x2d787e)[_0x4314bf(0xed)](this),_0x461394[_0x4314bf(0xcd)]={'addCommentThread':async({channelId:_0x4d3950,threadId:_0x114f30,comments:_0x15c675,resolvedAt:_0x371849,resolvedBy:_0x3fa64e,context:_0x144a22,attributes:_0x33f318})=>{const _0xd4d6d8=_0x4314bf,_0x2dc3f1=await this[_0xd4d6d8(0xe7)](_0x4d3950)[_0xd4d6d8(0xd5)]({'commentThreadId':_0x114f30,'comments':_0x15c675[_0xd4d6d8(0xf4)](_0x51136c=>function(_0x166f2b,_0x58836c,_0x10f4b3){const _0x3e9202=_0xd4d6d8;return{'commentThreadId':_0x10f4b3,'commentId':_0x166f2b[_0x3e9202(0x108)],'userId':_0x166f2b[_0x3e9202(0xf1)],'content':_0x166f2b[_0x3e9202(0xcc)],'documentId':_0x58836c,'createdAt':_0x166f2b[_0x3e9202(0xf7)],'attributes':_0x166f2b[_0x3e9202(0x127)]||{}};}(_0x51136c,_0x4d3950,_0x114f30)),'resolvedAt':_0x371849,'resolvedBy':_0x3fa64e,'context':_0x144a22,'attributes':_0x33f318})[_0xd4d6d8(0x10a)](B);return{'threadId':_0x2dc3f1[_0xd4d6d8(0x107)],'comments':_0x2dc3f1[_0xd4d6d8(0xf2)]};},'getCommentThread':async({channelId:_0x26650a,threadId:_0x39a236})=>{const _0x454540=_0x4314bf,_0x591557=await this[_0x454540(0xe7)](_0x26650a)[_0x454540(0xd6)](_0x39a236)[_0x454540(0x10a)](B);return await this[_0x454540(0x11d)]([_0x591557]),{'threadId':_0x591557[_0x454540(0x107)],'comments':_0x591557[_0x454540(0xf2)][_0x454540(0xf4)](R),'context':_0x591557[_0x454540(0x11f)],'resolvedAt':_0x591557[_0x454540(0x119)],'resolvedBy':_0x591557[_0x454540(0xf9)],'attributes':_0x591557[_0x454540(0x127)]||{}};},'updateCommentThread':async({channelId:_0x1c2075,threadId:_0x3856c6,context:_0x4ec7e1,unlinkedAt:_0x4d0724,attributes:_0xbcd415})=>this[_0x4314bf(0xe7)](_0x1c2075)[_0x4314bf(0x110)]({'commentThreadId':_0x3856c6,'context':_0x4ec7e1,'attributes':_0xbcd415,'unlinkedAt':_0x4d0724})[_0x4314bf(0x10a)](F)[_0x4314bf(0x10a)](B),'resolveCommentThread':async({channelId:_0x1137ba,threadId:_0x41a590})=>{const _0x55518d=_0x4314bf,_0x420019=await this[_0x55518d(0xe7)](_0x1137ba)[_0x55518d(0xd7)](_0x41a590)[_0x55518d(0x10a)](F)[_0x55518d(0x10a)](B);return{'threadId':_0x420019[_0x55518d(0x107)],'resolvedAt':_0x420019[_0x55518d(0x119)],'resolvedBy':_0x420019[_0x55518d(0xf9)]};},'reopenCommentThread':async({channelId:_0x54f741,threadId:_0x3de699})=>this[_0x4314bf(0xe7)](_0x54f741)[_0x4314bf(0xdd)](_0x3de699)[_0x4314bf(0x10a)](F)[_0x4314bf(0x10a)](B),'removeCommentThread':({channelId:_0x587d9f,threadId:_0x51d912})=>this[_0x4314bf(0xe7)](_0x587d9f)[_0x4314bf(0xd4)](_0x51d912)[_0x4314bf(0x10a)](F)[_0x4314bf(0x10a)](B),'addComment':({channelId:_0x357d07,threadId:_0x584d32,commentId:_0x44082f,content:_0x54c5a9,attributes:_0xd04791})=>this[_0x4314bf(0xe7)](_0x357d07)[_0x4314bf(0xfb)](_0x584d32,_0x44082f,_0x54c5a9,_0xd04791)[_0x4314bf(0x10a)](B),'updateComment':({channelId:_0x50c627,threadId:_0x30ad59,commentId:_0x25a1b3,content:_0x156c80,attributes:_0x1ed3be})=>this[_0x4314bf(0xe7)](_0x50c627)[_0x4314bf(0x120)](_0x30ad59,_0x25a1b3,_0x156c80,_0x1ed3be)[_0x4314bf(0x10a)](F)[_0x4314bf(0x10a)](B),'removeComment':({channelId:_0x2fa3b1,threadId:_0xb45f4c,commentId:_0xea250b})=>this[_0x4314bf(0xe7)](_0x2fa3b1)[_0x4314bf(0x10d)](_0xb45f4c,_0xea250b)[_0x4314bf(0x10a)](F)[_0x4314bf(0x10a)](B)},_0x51c246 instanceof _0x1bac0c){const _0x1ec7b5=_0x51c246[_0x4314bf(0xf3)][_0x4314bf(0xf0)](_0x4314bf(0x10b)),_0x319630=_0x51c246[_0x4314bf(0x112)][_0x4314bf(0xf0)](_0xb41493);await this[_0x4314bf(0x11e)](_0x1ec7b5);const _0xcb67a=await this[_0x4314bf(0x126)][_0x4314bf(0xf0)](_0x1ec7b5)[_0x4314bf(0xc9)]();this[_0x4314bf(0x102)](_0x319630,_0x4314bf(0xef)+_0x1ec7b5,(_0xd39362,{session:_0x143d71})=>{const _0x3bb273=_0x4314bf;_0x143d71['id']===_0x319630[_0x3bb273(0x109)]&&(_0xd39362[_0x3bb273(0x124)](),this[_0x3bb273(0x11f)][_0x3bb273(0x112)][_0x3bb273(0xf0)](_0x3bb273(0xdf))[_0x3bb273(0xd9)](_0x143d71[_0x3bb273(0x123)],_0x1ec7b5));}),_0x319630[_0x4314bf(0x121)](_0x1ec7b5,_0xcb67a);}}async[_0x1d5272(0x11e)](_0x13245b){const _0x2492f5=_0x1d5272;if(this[_0x2492f5(0x126)][_0x2492f5(0xfd)](_0x13245b))throw new _0xf8138b(_0x2492f5(0x10e),null,{'channelId':_0x13245b});const _0x5593b4=this[_0x2492f5(0x11f)][_0x2492f5(0x112)][_0x2492f5(0xf0)](_0x2492f5(0x105)),_0x18eee3=new a[(_0x2492f5(0x113))](_0x13245b);this[_0x2492f5(0x126)][_0x2492f5(0x117)](_0x13245b,_0x18eee3),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0xe4),(_0x35a2ca,_0x5a2834)=>{const _0x1864a4=_0x2492f5,{commentThreadId:_0x89a420,documentId:_0x3586b4,context:_0x10acef,attributes:_0x159f25,resolvedAt:_0x1189f1,resolvedBy:_0x321b12,comments:_0x41451f}=_0x5a2834;_0x5593b4[_0x1864a4(0xd6)](_0x89a420)||_0x5593b4[_0x1864a4(0xd5)]({'threadId':_0x89a420,'channelId':_0x3586b4,'comments':_0x41451f?_0x41451f[_0x1864a4(0xf4)](R):[],'context':_0x10acef,'attributes':_0x159f25,'resolvedAt':_0x1189f1,'resolvedBy':_0x321b12,'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0xd0),(_0x556757,{commentThreadId:_0x20d69c,documentId:_0x36bdb9,context:_0x28f51a,unlinkedAt:_0x2fa544,attributes:_0x1c92c5})=>{const _0x381f80=_0x2492f5;_0x5593b4[_0x381f80(0xd6)](_0x20d69c)&&_0x5593b4[_0x381f80(0x110)]({'threadId':_0x20d69c,'channelId':_0x36bdb9,'context':_0x28f51a,'unlinkedAt':_0x2fa544,'attributes':_0x1c92c5,'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0x115),(_0x58c952,{commentThreadId:_0x2ac1ed,resolvedBy:_0x599f41,resolvedAt:_0x24c06})=>{const _0x4163b6=_0x2492f5,_0x55ef99=_0x5593b4[_0x4163b6(0xd6)](_0x2ac1ed);_0x55ef99&&_0x55ef99[_0x4163b6(0xc7)]({'resolvedBy':_0x599f41,'resolvedAt':_0x24c06,'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0xcb),(_0x1aede4,{commentThreadId:_0x398b21})=>{const _0x428ecb=_0x2492f5,_0x425a8d=_0x5593b4[_0x428ecb(0xd6)](_0x398b21);_0x425a8d&&_0x425a8d[_0x428ecb(0xde)]({'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0xc6),(_0x5ba406,{commentThreadId:_0x62fa26})=>{const _0x49d6f9=_0x2492f5,_0x2ca9ab=_0x5593b4[_0x49d6f9(0xd6)](_0x62fa26);_0x2ca9ab&&_0x2ca9ab[_0x49d6f9(0xfc)]({'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0xfa),(_0xa2d18a,_0x2e2e6c)=>{const _0x546873=_0x2492f5,_0x3d3301=_0x2e2e6c[_0x546873(0x107)],_0x2725a7=_0x5593b4[_0x546873(0xd6)](_0x3d3301);_0x2725a7&&_0x2725a7[_0x546873(0xfb)]({...R(_0x2e2e6c),'isFromAdapter':!0x0});}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0x128),(_0x15b46c,{commentThreadId:_0x211a72,commentId:_0x59b45f,content:_0x3266db,attributes:_0x192933})=>{const _0x572c49=_0x2492f5,_0x4b8eed=_0x5593b4[_0x572c49(0xd6)](_0x211a72);if(_0x4b8eed){const _0x2243b3=_0x4b8eed[_0x572c49(0xe1)](_0x59b45f);_0x2243b3&&_0x2243b3[_0x572c49(0x11a)]({'content':_0x3266db,'attributes':_0x192933,'isFromAdapter':!0x0});}}),this[_0x2492f5(0x102)](_0x18eee3,_0x2492f5(0x114),(_0x5b7589,{commentThreadId:_0x1d1256,commentId:_0x3e6472})=>{const _0x1110c5=_0x2492f5,_0x23a275=_0x5593b4[_0x1110c5(0xd6)](_0x1d1256);if(_0x23a275){const _0x3a0ac2=_0x23a275[_0x1110c5(0xe1)](_0x3e6472);_0x3a0ac2&&_0x3a0ac2[_0x1110c5(0xfc)]({'isFromAdapter':!0x0});}}),await this[_0x2492f5(0xee)](_0x13245b);}[_0x1d5272(0x103)](){const _0x144b43=_0x1d5272;if(this[_0x144b43(0x11f)]instanceof _0x1bac0c){const _0x1d6861=this[_0x144b43(0x11f)][_0x144b43(0xf3)][_0x144b43(0xf0)](_0x144b43(0x10b));this[_0x144b43(0xce)](_0x1d6861);}}[_0x1d5272(0xce)](_0x5ac24e){const _0x1c19c3=_0x1d5272;if(!this[_0x1c19c3(0x126)][_0x1c19c3(0xfd)](_0x5ac24e))throw new _0xf8138b(_0x1c19c3(0x111),null,{'channelId':_0x5ac24e});this[_0x1c19c3(0xe7)](_0x5ac24e)[_0x1c19c3(0xd8)](),this[_0x1c19c3(0x126)][_0x1c19c3(0x101)](_0x5ac24e);}async[_0x1d5272(0xda)](){const _0x47cfed=_0x1d5272;for(const _0x22aec6 of this[_0x47cfed(0x126)][_0x47cfed(0x106)]())await this[_0x47cfed(0xee)](_0x22aec6);if(this[_0x47cfed(0x11f)]instanceof _0x1bac0c){const _0x1f1a8b=this[_0x47cfed(0x11f)][_0x47cfed(0xf3)][_0x47cfed(0xf0)](_0x47cfed(0x10b)),_0x2d04a0=this[_0x47cfed(0x11f)][_0x47cfed(0x112)][_0x47cfed(0xf0)](_0xb41493);_0x2d04a0[_0x47cfed(0xcf)](_0x1f1a8b);const _0x22ae5a=await this[_0x47cfed(0x126)][_0x47cfed(0xf0)](_0x1f1a8b)[_0x47cfed(0xc9)]();_0x2d04a0[_0x47cfed(0x121)](_0x1f1a8b,_0x22ae5a);}}async[_0x1d5272(0xee)](_0x2887c0){const _0x2d5115=_0x1d5272,{connection:_0x5ed1a7}=this[_0x2d5115(0x11f)][_0x2d5115(0x112)][_0x2d5115(0xf0)](_0x2d787e),_0x1db439=this[_0x2d5115(0x11f)][_0x2d5115(0x112)][_0x2d5115(0xf0)](_0x2d5115(0x105)),_0x34a106=this[_0x2d5115(0x126)][_0x2d5115(0xf0)](_0x2887c0),_0x10e498=await _0x34a106[_0x2d5115(0x10f)](_0x5ed1a7);await this[_0x2d5115(0x11d)](_0x10e498);const _0x4b0189=new Set(Array[_0x2d5115(0x122)](_0x1db439[_0x2d5115(0xe2)]({'channelId':_0x2887c0}),_0x53e753=>_0x53e753['id']));for(const _0x15c06e of _0x10e498)_0x15c06e[_0x2d5115(0xd2)]||_0x4b0189[_0x2d5115(0x101)](_0x15c06e[_0x2d5115(0x107)]);for(const _0x4fc05a of _0x4b0189)_0x1db439[_0x2d5115(0xd6)](_0x4fc05a)[_0x2d5115(0xfc)]({'isFromAdapter':!0x0});for(const _0x3a6424 of _0x10e498){let _0x27dd66=_0x1db439[_0x2d5115(0xd6)](_0x3a6424[_0x2d5115(0x107)]);const {commentThreadId:_0x115b4f,context:_0x5a144f,attributes:_0x1e39e0,resolvedBy:_0x5b6a1c,resolvedAt:_0x1a9e49,unlinkedAt:_0x50c84d,deletedAt:_0x1ca1e7}=_0x3a6424;if(_0x1ca1e7)continue;_0x27dd66||(_0x27dd66=_0x1db439[_0x2d5115(0xd5)]({'channelId':_0x2887c0,'threadId':_0x115b4f,'context':_0x5a144f,'attributes':_0x1e39e0||{},'resolvedBy':_0x5b6a1c,'resolvedAt':_0x1a9e49,'unlinkedAt':_0x50c84d,'isFromAdapter':!0x0}));const _0x32e59e=new Set(Array[_0x2d5115(0x122)](_0x27dd66[_0x2d5115(0xf2)],_0x5b6e74=>_0x5b6e74['id']));for(const _0xfe7273 of _0x3a6424[_0x2d5115(0xf2)])_0x32e59e[_0x2d5115(0x101)](_0xfe7273[_0x2d5115(0x108)]);for(const _0x6e0723 of _0x32e59e)_0x27dd66[_0x2d5115(0xe1)](_0x6e0723)[_0x2d5115(0xfc)]({'isFromAdapter':!0x0});for(const _0x251427 of _0x3a6424[_0x2d5115(0xf2)]){const _0xc88afb=_0x27dd66[_0x2d5115(0xe1)](_0x251427[_0x2d5115(0x108)]);_0xc88afb?_0xc88afb[_0x2d5115(0xcc)]!==_0x251427[_0x2d5115(0xcc)]&&_0xc88afb[_0x2d5115(0x11a)]({'content':_0x251427[_0x2d5115(0xcc)],'isFromAdapter':!0x0}):_0x27dd66[_0x2d5115(0xfb)](Object[_0x2d5115(0xe5)](R(_0x251427),{'isFromAdapter':!0x0}));}}}[_0x1d5272(0xe7)](_0x295716){const _0x2099ba=_0x1d5272;if(!this[_0x2099ba(0x126)][_0x2099ba(0xfd)](_0x295716))throw new _0xf8138b(_0x2099ba(0xfe),null,{'channelId':_0x295716});return this[_0x2099ba(0x126)][_0x2099ba(0xf0)](_0x295716);}async[_0x1d5272(0x11d)](_0x466b1a){const _0x1db1b6=_0x1d5272,_0x245e99=this[_0x1db1b6(0x11f)][_0x1db1b6(0x112)][_0x1db1b6(0xf0)](_0x4e1e0d),{connection:_0x2d6755}=this[_0x1db1b6(0x11f)][_0x1db1b6(0x112)][_0x1db1b6(0xf0)](_0x2d787e),_0x3944d6=new Set();for(const {resolvedBy:_0x15e406,comments:_0x30822d}of _0x466b1a){_0x15e406&&!_0x245e99[_0x1db1b6(0xe8)](_0x15e406)&&_0x3944d6[_0x1db1b6(0xf8)](_0x15e406);for(const {userId:_0x2153d7}of _0x30822d)_0x245e99[_0x1db1b6(0xe8)](_0x2153d7)||_0x3944d6[_0x1db1b6(0xf8)](_0x2153d7);}if(0x0===_0x3944d6[_0x1db1b6(0x116)])return;const _0x40880c=await _0x42be7d[_0x1db1b6(0xea)](_0x2d6755,Array[_0x1db1b6(0x122)](_0x3944d6));for(const _0x392c15 of _0x40880c)_0x245e99[_0x1db1b6(0xe8)](_0x392c15['id'])||_0x245e99[_0x1db1b6(0x10c)](_0x392c15);}}a[_0x1d5272(0x113)]=_0x2163d8;export default a;async function F(_0x59b491){const _0x686d93=_0x1d5272;if(_0x686d93(0xdc)!==_0x59b491[_0x686d93(0xc8)])throw _0x59b491;}function B(_0x5c7f52){const _0x19a9d4=_0x1d5272;if((_0x493243=_0x5c7f52)[_0x19a9d4(0x100)][_0x19a9d4(0xeb)](_0x19a9d4(0x11c))||_0x493243[_0x19a9d4(0x100)][_0x19a9d4(0xeb)](_0x19a9d4(0xf6))||_0x493243[_0x19a9d4(0x100)][_0x19a9d4(0xeb)](_0x19a9d4(0xd3)))return new Promise(()=>{});var _0x493243;throw _0x5c7f52;}function R(_0x52dada){const _0x1d6c05=_0x1d5272;return{'threadId':_0x52dada[_0x1d6c05(0x107)],'commentId':_0x52dada[_0x1d6c05(0x108)],'content':_0x52dada[_0x1d6c05(0xcc)],'createdAt':_0x52dada[_0x1d6c05(0xf7)],'authorId':_0x52dada[_0x1d6c05(0x125)],'attributes':_0x52dada[_0x1d6c05(0x127)]||{}};}