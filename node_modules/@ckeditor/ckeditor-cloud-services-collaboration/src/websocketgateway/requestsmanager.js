/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x4bc546 from'../ckeditorcloudserviceserror.js';class WebSocketRequest{constructor(_0x27333f,_0x3e80d6){this['_context']=_0x27333f,this['_deferredPromise']=(function(){let _0x2eb3ed,_0x30eef5;const _0x25ecdf=new Promise((_0x3b0e2d,_0x2a1689)=>{_0x2eb3ed=_0x3b0e2d,_0x30eef5=_0x2a1689;});return{'resolve':_0x2eb3ed,'reject':_0x30eef5,'promise':_0x25ecdf};}()),this['timeout']=setTimeout(()=>this['error'](new _0x4bc546('Request\x20timeout.',this['_context'])),_0x3e80d6);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x31831e){this['_deferredPromise']['resolve'](_0x31831e);}['error'](_0x11488a){this['_deferredPromise']['reject'](_0x11488a);}}export default class WebSocketGatewayRequestsManager{constructor(_0x24016d){this['_context']=_0x24016d,this['_requests']=new Set();}async['send'](_0x2ba2a9,_0x3fc5db=0xafc8){const _0x1cfbbb=this['_createRequest'](_0x3fc5db);try{return _0x2ba2a9(_0x1cfbbb),await _0x1cfbbb['promise'];}finally{this['_finishRequest'](_0x1cfbbb);}}['errorAll'](_0x42ac95){for(const _0xb2750c of this['_requests'])_0xb2750c['error'](_0x42ac95);}['waitForAllRequests'](_0x25e7d5=0xafc8){return this['_waitForRequests'](_0x25e7d5);}['_createRequest'](_0x143019){const _0x5630dc=new WebSocketRequest(this['_context'],_0x143019);return this['_requests']['add'](_0x5630dc),_0x5630dc;}['_finishRequest'](_0x2c8648){this['_requests']['delete'](_0x2c8648),clearTimeout(_0x2c8648['timeout']);}async['_waitForRequests'](_0x1aeab7=0x1388,_0x4bb67d=0x0){return!this['_requests']['size']||_0x4bb67d>=_0x1aeab7/0x1f4?Promise['resolve']():(await new Promise(_0x5c3272=>{setTimeout(_0x5c3272,0x1f4);}),this['_waitForRequests'](_0x1aeab7,_0x4bb67d++));}}